(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5994],{63:(e,r,a)=>{"use strict";var t=a(7260);a.o(t,"useParams")&&a.d(r,{useParams:function(){return t.useParams}}),a.o(t,"useRouter")&&a.d(r,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(r,{useSearchParams:function(){return t.useSearchParams}})},2280:(e,r,a)=>{Promise.resolve().then(a.bind(a,6706))},6706:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>c});var t=a(5155),s=a(2115),l=a(63),d=a(6489),n=a(2619),o=a.n(n),i=a(5239);function c(){var e;let{data:r,status:a}=(0,d.useSession)(),[n,c]=(0,s.useState)(null),[u,m]=(0,s.useState)(""),[x,p]=(0,s.useState)(!1),[b,h]=(0,s.useState)(0),[v,f]=(0,s.useState)(null),[g,y]=(0,s.useState)(!1),[j,N]=(0,s.useState)("light"),w=(0,l.useRouter)();if((0,s.useEffect)(()=>{let e=window.localStorage.getItem("podsum-dashboard-theme");if("light"===e||"dark"===e)return void N(e);N(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")},[]),(0,s.useEffect)(()=>{window.localStorage.setItem("podsum-dashboard-theme",j)},[j]),"loading"===a)return(0,t.jsx)("div",{className:"dashboard-shell min-h-screen text-[var(--text-main)] flex items-center justify-center","data-theme":j,children:(0,t.jsxs)("div",{className:"text-center rounded-2xl border border-[var(--border-soft)] bg-[var(--paper-base)] px-8 py-8 shadow-[0_18px_40px_-28px_rgba(80,67,44,0.45)]",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-2 border-[var(--border-medium)] border-t-[var(--btn-primary)] mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-[var(--text-muted)]",children:"Loading..."})]})});if("unauthenticated"===a)return w.replace("/auth/signin?callbackUrl=/upload"),null;let k=async e=>{var a,t;e.preventDefault();let s=u.trim();if(!n&&!s)return void f("Please select a .srt file or enter a YouTube URL.");if(!(null==r||null==(a=r.user)?void 0:a.id))return void f("User session not found. Please sign in again.");p(!0),h(0),f(null);let l=new FormData;n&&l.append("file",n),s&&(l.append("youtubeUrl",s),l.append("sourceReference",s)),l.append("isPublic",g.toString()),l.append("userId",r.user.id);try{let e=await fetch("/api/upload",{method:"POST",body:l}),r=await e.json();if(!e.ok)throw Error(r.error||r.details||"Upload failed");let a=null==r||null==(t=r.data)?void 0:t.id;if(!a)throw Error("Upload succeeded but podcast id is missing.");h(100),w.push("/dashboard/".concat(a))}catch(e){console.error("Upload error:",e),f(e instanceof Error?e.message:"An unknown error occurred during upload."),p(!1);return}p(!1)},S=x||!n&&!u.trim();return(0,t.jsxs)("div",{className:"dashboard-shell min-h-screen text-[var(--text-main)] flex flex-col","data-theme":j,children:[(0,t.jsx)("header",{className:"sticky top-0 z-20 border-b border-[var(--border-soft)] bg-[var(--header-bg)] backdrop-blur-xl",children:(0,t.jsxs)("div",{className:"mx-auto w-full max-w-[1400px] px-4 sm:px-6 lg:px-8 py-4 flex flex-col gap-3 md:flex-row md:justify-between md:items-center",children:[(0,t.jsxs)("nav",{className:"app-breadcrumb-nav",children:[(0,t.jsxs)(o(),{href:"/",className:"app-breadcrumb-link",children:[(0,t.jsx)(i.default,{src:"/podcast-summarizer-icon.svg",alt:"PodSum logo",width:28,height:28}),(0,t.jsx)("span",{children:"PodSum.cc"})]}),(0,t.jsx)("span",{className:"app-breadcrumb-divider",children:"/"}),(0,t.jsx)("span",{className:"app-breadcrumb-current",children:"Upload"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 flex-wrap",children:[(0,t.jsxs)("div",{className:"inline-flex items-center rounded-lg border border-[var(--border-soft)] bg-[var(--paper-base)] p-0.5",children:[(0,t.jsx)("button",{onClick:()=>N("light"),className:"px-2.5 py-1.5 text-xs rounded-md transition-colors ".concat("light"===j?"bg-[var(--btn-primary)] text-[var(--btn-primary-text)]":"text-[var(--text-secondary)] hover:bg-[var(--paper-muted)]"),children:"Light Mode"}),(0,t.jsx)("button",{onClick:()=>N("dark"),className:"px-2.5 py-1.5 text-xs rounded-md transition-colors ".concat("dark"===j?"bg-[var(--btn-primary)] text-[var(--btn-primary-text)]":"text-[var(--text-secondary)] hover:bg-[var(--paper-muted)]"),children:"Dark Mode"})]}),(0,t.jsx)(o(),{href:"/my",className:"bg-[var(--paper-base)] hover:bg-[var(--paper-muted)] border border-[var(--border-soft)] text-[var(--text-secondary)] text-sm font-medium py-2 px-4 sm:px-6 rounded-lg transition-colors",children:"Back to History"})]})]})}),(0,t.jsx)("main",{className:"container mx-auto w-full max-w-[1400px] p-4 sm:p-6 lg:p-8 flex-grow",children:(0,t.jsxs)("section",{className:"dashboard-panel rounded-2xl p-5 sm:p-6 lg:p-8 w-full max-w-3xl mx-auto",children:[(0,t.jsxs)("div",{className:"mb-6 space-y-2",children:[(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-[var(--heading)]",children:"Upload SRT or YouTube"}),(0,t.jsxs)("p",{className:"text-sm text-[var(--text-muted)]",children:["Signed in as ",(0,t.jsx)("span",{className:"font-semibold text-[var(--heading)]",children:null==r||null==(e=r.user)?void 0:e.email})]})]}),(0,t.jsxs)("form",{onSubmit:k,className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"srtFile",className:"block text-sm font-medium text-[var(--text-secondary)] mb-2",children:"SRT File Input"}),(0,t.jsx)("input",{id:"srtFile",name:"srtFile",type:"file",accept:".srt,application/x-subrip",onChange:e=>{var r;let a=(null==(r=e.target.files)?void 0:r[0])||null;c(a),a&&f(null)},className:"block w-full text-sm text-[var(--text-secondary)] file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-[var(--btn-primary)] file:text-[var(--btn-primary-text)] hover:file:bg-[var(--btn-primary-hover)] disabled:opacity-50 disabled:pointer-events-none",disabled:x}),n&&(0,t.jsxs)("p",{className:"mt-2 text-xs text-[var(--text-muted)]",children:["Selected: ",n.name," (",(n.size/1024).toFixed(2)," KB)"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"youtubeUrl",className:"block text-sm font-medium text-[var(--text-secondary)] mb-2",children:"Or YouTube URL"}),(0,t.jsx)("input",{id:"youtubeUrl",name:"youtubeUrl",type:"url",placeholder:"https://www.youtube.com/watch?v=...",value:u,onChange:e=>m(e.target.value),className:"w-full rounded-lg border border-[var(--border-soft)] bg-[var(--paper-base)] px-3 py-2.5 text-sm text-[var(--text-main)] placeholder:text-[var(--text-muted)] focus:outline-none focus:border-[var(--border-medium)]",disabled:x})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",className:"sr-only",checked:g,onChange:()=>y(e=>!e)}),(0,t.jsx)("span",{className:"relative h-6 w-11 rounded-full transition-colors ".concat(g?"bg-[var(--btn-primary)]":"bg-[var(--border-medium)]"),children:(0,t.jsx)("span",{className:"absolute left-1 top-1 h-4 w-4 rounded-full bg-white transition-transform ".concat(g?"translate-x-5":"")})}),(0,t.jsx)("span",{className:"ml-3 text-sm text-[var(--text-secondary)]",children:"Make this analysis public"})]}),(0,t.jsx)("p",{className:"text-xs text-[var(--text-muted)]",children:"Public analyses can be viewed by anyone with the link."})]}),x&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"w-full h-2 rounded-full bg-[var(--paper-subtle)]",children:(0,t.jsx)("div",{className:"h-2 rounded-full bg-[var(--btn-primary)] transition-all duration-500 ease-out",style:{width:"".concat(b,"%")}})}),(0,t.jsx)("p",{className:"text-xs text-[var(--text-muted)] text-center",children:"Uploading and queueing analysis..."})]}),v&&(0,t.jsxs)("div",{className:"rounded-xl border border-[#d8b7b7] bg-[#fff5f5] text-[var(--danger)] px-4 py-3 text-sm",children:["Error: ",v]}),(0,t.jsx)("button",{type:"submit",disabled:S,className:"w-full rounded-lg bg-[var(--btn-primary)] hover:bg-[var(--btn-primary-hover)] disabled:bg-[var(--paper-subtle)] disabled:text-[var(--text-muted)] text-[var(--btn-primary-text)] font-semibold py-3 px-4 transition-colors disabled:cursor-not-allowed",children:x?"Uploading...":"Upload & Process"})]})]})})]})}}},e=>{e.O(0,[2619,6489,5239,8441,1255,7358],()=>e(e.s=2280)),_N_E=e.O()}]);